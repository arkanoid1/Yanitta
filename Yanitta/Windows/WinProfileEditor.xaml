<Window x:Class="Yanitta.WinProfileEditor"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Windows="clr-namespace:Yanitta.Windows"
        xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
        xmlns:res="clr-namespace:Yanitta.Properties"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:yanitta="clr-namespace:Yanitta"
        Title="{x:Static yanitta:Localization.EditorTitle}"
        Width="1280"
        Height="800"
        FontFamily="../Resources/#MORPHEUS"
        Style="{DynamicResource KamillaStyle}"
        Closing="Window_Closing_1"
        Icon="/Yanitta;component/Resources/BNUpdate.png">

    <Window.InputBindings>
        <KeyBinding Command="Save"  Key="S"  Modifiers="Control" />
        <KeyBinding Command="Close" Key="F4" Modifiers="Alt" />
    </Window.InputBindings>

    <Window.CommandBindings>
        <CommandBinding Command="Close" Executed="CommandBinding_Executed_Close" />
        <CommandBinding Command="Save"  Executed="CommandBinding_Executed_Save" />

        <CommandBinding Command="yanitta:YanittaCommand.Import"  Executed="CommandBinding_Executed_Import" />
        <CommandBinding Command="yanitta:YanittaCommand.Export"  Executed="CommandBinding_Executed_Export" />

        <CommandBinding Command="yanitta:YanittaCommand.Update"  Executed="CommandBinding_Executed_Update" />
        <CommandBinding Command="yanitta:YanittaCommand.Reload"  Executed="CommandBinding_Executed_Reload" />
    </Window.CommandBindings>

    <Grid x:Name="mainGrid" DataContext="{Binding Source={x:Static yanitta:ProfileDb.Instance}}">
        <Grid.RowDefinitions>
            <RowDefinition Height="23" />
            <RowDefinition />
            <RowDefinition Height="23" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="80" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <TabControl Grid.Column="1" Grid.Row="1">
            <TabItem Header="{x:Static yanitta:Localization.AbilityList}">
                <TabItem.InputBindings>
                    <KeyBinding Command="yanitta:YanittaCommand.AddAbility" Key="Insert" />
                </TabItem.InputBindings>
                <TabItem.CommandBindings>
                    <CommandBinding Command="yanitta:YanittaCommand.AddAbility"    Executed="CommandBinding_Executed_AddAbility" />
                    <CommandBinding Command="yanitta:YanittaCommand.CopyAbility"   Executed="CommandBinding_Executed_CopyAbility" />
                    <CommandBinding Command="yanitta:YanittaCommand.DeleteAbility" Executed="CommandBinding_Executed_DeleteAbility" />
                </TabItem.CommandBindings>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40" />
                        <RowDefinition />
                        <RowDefinition Height="208" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="459" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <GridSplitter Grid.RowSpan="3" Grid.Column="1" Width="4" HorizontalAlignment="Left" />
                    <GridSplitter Grid.RowSpan="3" Grid.Column="1" Width="4" HorizontalAlignment="Left" />
                    <Grid Grid.Row="1" Grid.RowSpan="2" Grid.Column="0">
                        <ListView x:Name="abilityList" Margin="0,0,0,8" IsSynchronizedWithCurrentItem="True" ItemsSource="{Binding ProfileList/AbilityList}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn DisplayMemberBinding="{Binding SpellID}" Header="{x:Static yanitta:Localization.Spell}" />
                                    <GridViewColumn Width="150" DisplayMemberBinding="{Binding Name}" Header="{x:Static yanitta:Localization.Name}" />

                                    <GridViewColumn Header="{x:Static yanitta:Localization.Target}" Width="100" x:Name="hTarget">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <ComboBox Width="{Binding ElementName=hTarget, Path=Width, Converter={StaticResource ResizeConverter}, ConverterParameter=-10}"
                                                          ItemsSource="{Binding Source={StaticResource TargetValues}}"
                                                          SelectedValue="{Binding Target}"
                                                          ToolTip="{x:Static yanitta:Localization.TargetToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Header="{x:Static yanitta:Localization.IsMovingCheck}" Width="100" x:Name="hIsMovingCheck">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <ComboBox Width="{Binding ElementName=hIsMovingCheck, Path=Width, Converter={StaticResource ResizeConverter}, ConverterParameter=-10}"
                                                          ItemsSource="{Binding Source={StaticResource MovingValues}}"
                                                          SelectedValue="{Binding IsMovingCheck}" ToolTip="{x:Static yanitta:Localization.IsMovingCheckToolTip}">
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Path=., Converter={StaticResource EnumToStr}}"
                                                                       ToolTip="{Binding Path=., Converter={StaticResource EnumToStr}, ConverterParameter=ToolTip}"/>
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.CancelChanel}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding CancelChannel}" ToolTip="{x:Static yanitta:Localization.CancelChanelToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.CancelCasting}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding CancelCasting}" ToolTip="{x:Static yanitta:Localization.CancelCastingToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.IsRangeCheck}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsRangeCheck}" ToolTip="{x:Static yanitta:Localization.IsRangeCheckToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.IsAttacedTarget}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsAttacedTarget}" ToolTip="{x:Static yanitta:Localization.IsAttacedTargetToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.IsUseIncombat}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsUseIncombat}" ToolTip="{x:Static yanitta:Localization.IsInCombatToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.IsSpellKnownCheck}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsSpellKnownCheck}" ToolTip="{x:Static yanitta:Localization.IsSpellKnownCheckToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.SetRecastDelay}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding SetRecastDelay}" ToolTip="{x:Static yanitta:Localization.SetRecastDelayToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="50" Header="{x:Static yanitta:Localization.IsNotHCD}">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsNotHCD}" ToolTip="{x:Static yanitta:Localization.IsNotHCDToolTip}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>

                    <ToolBar Height="40" VerticalAlignment="Top" Grid.RowSpan="2">
                        <Button x:Name="bAddAbility" Command="yanitta:YanittaCommand.AddAbility" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.AddAbility}">
                            <Image Source="/Resources/Add.png" />
                        </Button>
                        <Button x:Name="bCopyAbility" Command="yanitta:YanittaCommand.CopyAbility" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.CopyAbility}">
                            <Image Source="/Resources/Clipboard.png" />
                        </Button>
                        <Button x:Name="bDeleteAbility" Command="yanitta:YanittaCommand.DeleteAbility" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.DeleteAbility}">
                            <Image Source="/Resources/Denided.png" />
                        </Button>
                        <Separator />
                        <Button x:Name="bAbMoveUp" Foreground="Transparent" Click="bAbMoveUp_Click_1">
                            <Image Source="/Resources/Button_Up.png" />
                        </Button>
                        <Button x:Name="bAbMoveDown" Foreground="Transparent" Click="bAbMoveDown_Click_1">
                            <Image Source="/Resources/Button_Down.png" />
                        </Button>
                        <Separator />
                        <Button x:Name="bSaveProfileToFile" Foreground="Transparent" Command="yanitta:YanittaCommand.Export" ToolTip="{x:Static yanitta:Localization.Export}">
                            <Image Source="/Resources/Export.png" />
                        </Button>
                        <Button x:Name="bLoadProfileFromFile" Foreground="Transparent" Command="yanitta:YanittaCommand.Import" ToolTip="{x:Static yanitta:Localization.Import}">
                            <Image Source="/Resources/Import.png" />
                        </Button>
                    </ToolBar>
                    <Grid Grid.RowSpan="3" Grid.Column="1" Margin="4,0" DataContext="{Binding ProfileList/AbilityList}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="200"/>
                            <RowDefinition Height="250*"/>
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100*"/>
                                <ColumnDefinition Width="100*"/>
                            </Grid.ColumnDefinitions>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Grid.Row="0" Margin="5,0" Text="{x:Static yanitta:Localization.Spell}" VerticalAlignment="Center"/>
                                <TextBox   Grid.Column="1" Grid.Row="0" Margin="5,0" Text="{Binding SpellID, UpdateSourceTrigger=PropertyChanged}" ToolTip="{x:Static yanitta:Localization.SpellIdToolTip}" TextAlignment="Right" />

                                <TextBlock Grid.Column="0" Grid.Row="1" Margin="5,0" Text="{x:Static yanitta:Localization.Name}" VerticalAlignment="Center"/>
                                <TextBox   Grid.Column="1" Grid.Row="1" Margin="5,0" Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Name="tbAbilityName" ToolTip="{x:Static yanitta:Localization.NameToolTip}"/>

                                <TextBlock Grid.Column="0" Grid.Row="2" Margin="5,0" Text="{x:Static yanitta:Localization.Target}" ToolTip="" VerticalAlignment="Center"/>
                                <ComboBox  Grid.Column="1" Grid.Row="2" Margin="5,0" ItemsSource="{Binding Source={StaticResource TargetValues}}"
                                                          SelectedValue="{Binding Target}" ToolTip="{x:Static yanitta:Localization.TargetToolTip}"/>
                                <TextBlock Grid.Column="0" Grid.Row="3" Margin="5,0" Text="{x:Static yanitta:Localization.IsMovingCheck}" ToolTip="" VerticalAlignment="Center"/>
                                <ComboBox  Grid.Column="1" Grid.Row="3" Margin="5,0" ItemsSource="{Binding Source={StaticResource MovingValues}}"
                                                          SelectedValue="{Binding IsMovingCheck}" ToolTip="{x:Static yanitta:Localization.IsMovingCheckToolTip}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Path=., Converter={StaticResource EnumToStr}}"
                                                       ToolTip="{Binding Path=., Converter={StaticResource EnumToStr}, ConverterParameter=ToolTip}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </Grid>

                            <StackPanel Grid.Column="2">
                                <CheckBox Margin="3" IsChecked="{Binding IsUseIncombat}"     Content="{x:Static yanitta:Localization.IsUseIncombat}"     ToolTip="{x:Static yanitta:Localization.IsInCombatToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding IsAttacedTarget}"   Content="{x:Static yanitta:Localization.IsAttacedTarget}"   ToolTip="{x:Static yanitta:Localization.IsAttacedTargetToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding IsRangeCheck}"      Content="{x:Static yanitta:Localization.IsRangeCheck}"      ToolTip="{x:Static yanitta:Localization.IsRangeCheckToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding IsSpellKnownCheck}" Content="{x:Static yanitta:Localization.IsSpellKnownCheck}" ToolTip="{x:Static yanitta:Localization.IsSpellKnownCheckToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding SetRecastDelay}"    Content="{x:Static yanitta:Localization.SetRecastDelay}"    ToolTip="{x:Static yanitta:Localization.SetRecastDelayToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding IsNotHCD}"          Content="{x:Static yanitta:Localization.IsNotHCD}"          ToolTip="{x:Static yanitta:Localization.IsNotHCDToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding CancelCasting}"     Content="{x:Static yanitta:Localization.CancelCasting}"     ToolTip="{x:Static yanitta:Localization.CancelCastingToolTip}"/>
                                <CheckBox Margin="3" IsChecked="{Binding CancelChannel}"     Content="{x:Static yanitta:Localization.CancelChanel}"      ToolTip="{x:Static yanitta:Localization.CancelChanelToolTip}"/>
                            </StackPanel>
                        </Grid>
                        <Border BorderThickness="1" BorderBrush="#FF009600" Grid.Row="1">
                            <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding Lua, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="{x:Static yanitta:Localization.RotationList}">
                <TabItem.InputBindings>
                    <KeyBinding Command="yanitta:YanittaCommand.AddRotation" Key="Insert" />
                </TabItem.InputBindings>
                <TabItem.CommandBindings>
                    <CommandBinding Command="yanitta:YanittaCommand.AddRotation"      Executed="CommandBinding_Executed_AddRotation" />
                    <CommandBinding Command="yanitta:YanittaCommand.CopyRotation"     Executed="CommandBinding_Executed_CopyRotation" />
                    <CommandBinding Command="yanitta:YanittaCommand.DeleteRotation"   Executed="CommandBinding_Executed_DeleteRotation" />
                    <CommandBinding Command="yanitta:YanittaCommand.RefreshRotation"  Executed="CommandBinding_Executed_RefreshRotation" />
                </TabItem.CommandBindings>
                <Grid>
                    <Grid.Resources>
                        <CollectionViewSource x:Key="AlavilableAbilityList" Source="{Binding ProfileList/AbilityList}" />
                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="400*" />
                        <ColumnDefinition Width="200*" />
                        <ColumnDefinition Width="200*" />
                        <ColumnDefinition Width="7*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40" />
                        <RowDefinition Height="147*" />
                        <RowDefinition Height="251*" />
                    </Grid.RowDefinitions>

                    <ListView Grid.Row="1" Margin="0,0,3,4" x:Name="rotationList" IsSynchronizedWithCurrentItem="true" ItemsSource="{Binding ProfileList/RotationList}" SelectionChanged="rotationList_SelectionChanged_1">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Width="200" DisplayMemberBinding="{Binding Name}" Header="{x:Static yanitta:Localization.Name}" />
                                <GridViewColumn Width="50" Header="Proc">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding ProcNotifyer}" ToolTip="{x:Static yanitta:Localization.ProcNotifyerToolTip}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Width="30" Header="Control">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding HotKey.Control}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Width="30" Header="Shift">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding HotKey.Shift}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Width="30" Header="Alt">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding HotKey.Alt}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Key">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox Width="150" SelectedValue="{Binding HotKey.Key}" ItemsSource="{Binding Source={StaticResource KeyValues}}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <ListBox x:Name="listBoxAlavilableAbilitys" Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" Margin="0,0,3,0"
                             ItemsSource="{Binding Source={StaticResource AlavilableAbilityList}}"
                             DisplayMemberPath="Name"
                             Style="{DynamicResource KamillaStyle}" MouseDoubleClick="listBoxAlavilableAbilitys_MouseDoubleClick" />

                    <ListBox x:Name="rotationListAbilitys" Grid.Row="1" Grid.RowSpan="2" Grid.Column="2" Margin="43,0,0,0"
                             ItemsSource="{Binding ProfileList/RotationList/AbilityQueue}"
                             Style="{DynamicResource KamillaStyle}" MouseDoubleClick="rotationListAbilitys_MouseDoubleClick" />

                    <Button x:Name="bMoveTo" Grid.Row="1" Grid.Column="2" Width="34" Height="26" Margin="3,18,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Background="Transparent"
                            Click="bMoveTo_Click_1">
                        <Image Source="/Resources/Button_Next.png" />
                    </Button>
                    <Button x:Name="bMoveFrom" Grid.Row="1" Grid.Column="2" Width="34" Height="26" Margin="3,50,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                            Click="bMoveFrom_Click_1">
                        <Image Source="/Resources/Button_Back.png" />
                    </Button>
                    <Button x:Name="bMoveUp" Grid.Row="1" Grid.Column="2" Width="34" Height="26" Margin="3,82,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                            Click="bMoveUp_Click_1">
                        <Image Source="/Resources/Button_Up.png" />
                    </Button>
                    <Button x:Name="bMoveDown" Grid.Row="1" Grid.Column="2" Width="34" Height="26" Margin="3,114,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                            Click="bMoveDown_Click_1">
                        <Image Source="/Resources/Button_Down.png" />
                    </Button>
                    <Button Grid.Row="2" Grid.Column="2" Width="34" Height="26" Margin="3,50,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                            Command="yanitta:YanittaCommand.RefreshRotation">
                        <Image Source="/Resources/Refresh.png" />
                    </Button>

                    <ToolBar Grid.ColumnSpan="1" Height="40" VerticalAlignment="Top">
                        <Button Command="yanitta:YanittaCommand.AddRotation" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.AddRotation}">
                            <Image Source="/Resources/Add.png" />
                        </Button>
                        <Button Command="yanitta:YanittaCommand.CopyRotation" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.CopyRotation}">
                            <Image Source="/Resources/Clipboard.png" />
                        </Button>
                        <Button Command="yanitta:YanittaCommand.DeleteRotation" Foreground="Transparent" ToolTip="{x:Static yanitta:Localization.DeleteRotation}">
                            <Image Source="/Resources/Denided.png" />
                        </Button>
                    </ToolBar>

                    <TabControl Grid.Row="2" Margin="0,28,0,0">
                        <TabItem Header="{x:Static yanitta:Localization.Rotation_Note}" ToolTip="{x:Static yanitta:Localization.Rotation_Note_ToolTip}">
                            <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding ProfileList/RotationList/Notes, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </TabItem>
                        <TabItem Header="{x:Static yanitta:Localization.Rotation_Code}" ToolTip="{x:Static yanitta:Localization.Rotation_Code_ToolTip}">
                            <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding ProfileList/RotationList/Lua, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </TabItem>
                    </TabControl>
                    <Grid Grid.Row="2" Height="23" VerticalAlignment="Top">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="311*"/>
                            <ColumnDefinition Width="155*"/>
                            <ColumnDefinition Width="124*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Name="tbRotationName"  Height="23" Text="{Binding ProfileList/RotationList/Name, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <TextBlock Grid.Column="1" TextAlignment="Right" Text="{x:Static yanitta:Localization.Rotation_TickDelay}" VerticalAlignment="Center" />
                        <TextBox Grid.Column="2" Text="{Binding ProfileList/RotationList/TickDelay, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" ToolTip="{x:Static yanitta:Localization.Rotation_TickDelayToolTip}"/>
                    </Grid>
                    <Label Grid.Column="1" Width="176" Height="26" Margin="5,1,5,0" HorizontalAlignment="Center" VerticalAlignment="Top" HorizontalContentAlignment="Center"
                           Content="{x:Static yanitta:Localization.AlavilableAbilitys}" />
                    <Label Grid.Column="2" Width="168" Height="26" Margin="43,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" HorizontalContentAlignment="Center"
                           Content="{x:Static yanitta:Localization.CurrentRotation}" />
                </Grid>
            </TabItem>
            <TabItem Header="{x:Static yanitta:Localization.BeforeRotationCode}" ToolTip="{x:Static yanitta:Localization.BeforeRotationCodeToolTip}">
                <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding ProfileList/Lua, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
            </TabItem>
            <TabItem Header="{x:Static yanitta:Localization.CoreHeader}" ToolTip="{x:Static yanitta:Localization.CoreHeaderToolTip}">
                <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding Core, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
            </TabItem>
            <TabItem Header="{x:Static yanitta:Localization.GlobalFunk}" ToolTip="{x:Static yanitta:Localization.GlobalFunkToolTip}">
                <avalonedit:TextEditor FontFamily="Consolas" Text="{Binding Func, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
            </TabItem>
            <TabItem Header="{x:Static yanitta:Localization.ProfileInfo}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{x:Static yanitta:Localization.Author}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="5" Width="150" />
                        <TextBox Width="500" Text="{Binding Author, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" FontFamily="Consolas" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{x:Static yanitta:Localization.Version}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="5" Width="150" />
                        <TextBox Width="500" Text="{Binding Version, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" VerticalAlignment="Center" FontFamily="Consolas" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{x:Static yanitta:Localization.UpdAdress}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="5" Width="150" />
                        <TextBox Width="500" Text="{Binding Url, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" FontFamily="Consolas" />
                    </StackPanel>
                </StackPanel>
            </TabItem>
        </TabControl>

        <ListBox x:Name="profiLeList" IsSynchronizedWithCurrentItem="true" ItemsSource="{Binding ProfileList}" SelectionChanged="rotationList_SelectionChanged_1" Grid.Row="1">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Image Source="{Binding Class, Converter={StaticResource enumToImage}}" Width="64"
                           ToolTip="{Binding Class, Converter={StaticResource EnumToStr}}" Cursor="Hand" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <Menu Grid.ColumnSpan="2">
            <MenuItem Header="{x:Static yanitta:Localization.File}">
                <MenuItem Header="{x:Static yanitta:Localization.Save}"      ToolTip="{x:Static yanitta:Localization.SaveToolTip}"   Command="Save" />
                <MenuItem Header="{x:Static yanitta:Localization.Reload}"    ToolTip="{x:Static yanitta:Localization.ReloadToolTip}" Command="yanitta:YanittaCommand.Reload" />
                <MenuItem Header="{x:Static yanitta:Localization.Update}"    ToolTip="{x:Static yanitta:Localization.UpdateToolTip}" Command="yanitta:YanittaCommand.Update" />
                <MenuItem Header="{x:Static yanitta:Localization.Close}"     ToolTip="{x:Static yanitta:Localization.CloseToolTip}"  Command="Close" />
            </MenuItem>
            <MenuItem Header="{x:Static yanitta:Localization.AbilityList}">
                <MenuItem Header="{x:Static yanitta:Localization.AddAbility}"        ToolTip="{x:Static yanitta:Localization.AddAbility}"      Command="yanitta:YanittaCommand.AddAbility" />
                <MenuItem Header="{x:Static yanitta:Localization.CopyAbility}"       ToolTip="{x:Static yanitta:Localization.CopyAbility}"     Command="yanitta:YanittaCommand.CopyAbility" />
                <MenuItem Header="{x:Static yanitta:Localization.DeleteAbility}"     ToolTip="{x:Static yanitta:Localization.DeleteAbility}"   Command="yanitta:YanittaCommand.DeleteAbility" />
            </MenuItem>
            <MenuItem Header="{x:Static yanitta:Localization.RotationList}">
                <MenuItem Header="{x:Static yanitta:Localization.AddRotation}"       ToolTip="{x:Static yanitta:Localization.AddRotation}"     Command="yanitta:YanittaCommand.AddRotation" />
                <MenuItem Header="{x:Static yanitta:Localization.CopyRotation}"      ToolTip="{x:Static yanitta:Localization.CopyRotation}"    Command="yanitta:YanittaCommand.CopyRotation" />
                <MenuItem Header="{x:Static yanitta:Localization.DeleteRotation}"    ToolTip="{x:Static yanitta:Localization.DeleteRotation}"  Command="yanitta:YanittaCommand.DeleteRotation" />
            </MenuItem>
            <MenuItem Header="{x:Static yanitta:Localization.Help}">
                <MenuItem Header="{x:Static yanitta:Localization.Help}" ToolTip="{x:Static yanitta:Localization.HelpToolTip}" Command="Help" />
            </MenuItem>
        </Menu>

        <StatusBar Grid.ColumnSpan="2" Grid.Row="2">
            <TextBlock Text="{x:Static yanitta:Localization.CurentProfile}"/>
            <Image Source="{Binding ProfileList/Class, Converter={StaticResource enumToImage}}" />
            <TextBlock Text="{Binding ProfileList/Class, Converter={StaticResource EnumToStr}}" Width="100"/>
            <Separator />
            <TextBlock Text="{x:Static yanitta:Localization.AbilityCount}"/>
            <TextBlock Text="{Binding ProfileList/AbilityList, Converter={StaticResource CollectionToCount}}" Width="30"/>
            <Separator />
            <TextBlock Text="{x:Static yanitta:Localization.RotationCount}"/>
            <TextBlock Text="{Binding ProfileList/RotationList, Converter={StaticResource CollectionToCount}}" Width="30"/>
            <Separator />
            <TextBlock Text="{x:Static yanitta:Localization.Author}"/>
            <TextBlock Text="{Binding Author}"/>
            <Separator />
            <TextBlock Text="{x:Static yanitta:Localization.Version}"/>
            <TextBlock Text="{Binding Version}"/>
        </StatusBar>
    </Grid>
</Window>